<!-- pages/weight-chart/weight-chart.wxml -->
<view class="container">
  <view class="chart-title">体重生长曲线</view>
  
  <view class="chart-container">
    <canvas canvas-id="weight-chart" style="width: 100%; height: 300px; background-color: #fff;"></canvas>
  </view>
  
  <view class="chart-info">
    <text>WHO标准体重生长曲线</text>
    <text wx:if="{{childInfo.name}}">宝宝: {{childInfo.name}}</text>
  </view>
  
  <!-- 添加记录按钮 -->
  <view class="add-record-btn" bindtap="toggleAddForm">
    <text class="btn-icon">+</text>
    <text>添加体重记录</text>
  </view>

  <!-- 添加记录表单 -->
  <view class="add-form-mask" wx:if="{{showAddForm}}" bindtap="toggleAddForm"></view>
  <view class="add-form {{showAddForm ? 'show' : ''}}">
    <view class="form-header">
      <text class="form-title">添加体重记录</text>
      <text class="close-btn" bindtap="toggleAddForm">×</text>
    </view>
    
    <view class="form-item">
      <text class="form-label">日期</text>
      <picker mode="date" value="{{newRecord.date}}" bindchange="onDateChange">
        <view class="picker">{{newRecord.date || '请选择日期'}}</view>
      </picker>
    </view>
    
    <view class="form-item">
      <text class="form-label">体重 (kg)</text>
      <input type="digit" value="{{newRecord.weight}}" bindinput="onWeightInput" placeholder="请输入体重" />
    </view>
    
    <view class="form-tip">请输入准确的体重数据</view>
    
    <button class="submit-btn" bindtap="addGrowthRecord">保存记录</button>
  </view>

  <!-- 历史记录列表 -->
  <view class="records-list">
    <view class="list-header">
      <text class="header-title">历史记录</text>
      <text class="record-count">共{{growthRecords.length}}条</text>
    </view>
    
    <view class="empty-tip" wx:if="{{growthRecords.length === 0}}">
      暂无记录，请点击上方按钮添加
    </view>
    
    <view class="record-item" wx:for="{{growthRecords}}" wx:key="index">
      <view class="record-date">{{item.date}}</view>
      <view class="record-data">
        <text wx:if="{{item.weight !== null}}">体重: {{item.weight}}kg</text>
      </view>
      <view class="delete-btn" bindtap="deleteRecord" data-index="{{index}}">删除</view>
    </view>
  </view>
  
  <view class="back-button" bindtap="navigateBack">返回</view>
</view>